let newTab,tabId;function createNewTab(a){chrome.tabs.query({active:!0,currentWindow:!0},b=>{chrome.tabs.create({index:b[0].index+1,url:a},a=>{tabId=a.id,chrome.tabs.onRemoved.addListener(a=>{tabId===a&&(tabId=void 0)})})})}function onTransClick(a,b){const c=`http://translate.google.com/#auto/${b}/${encodeURIComponent(a.selectionText)}`;newTab||tabId===void 0?createNewTab(c):chrome.tabs.update(tabId,{active:!0,url:c},a=>{a?chrome.windows.update(a.windowId,{focused:!0}):createNewTab(c)}),ga("set","checkProtocolTask",()=>{}),ga("require","displayfeatures"),ga("send","pageview","/")}chrome.storage.sync.get({newTab:"false",languages:"[]"},a=>{newTab="true"===a.newTab;const b=JSON.parse(a.languages);b.forEach(a=>{chrome.contextMenus.create({title:1===b.length?`Translate "%s" to ${a.name}`:`To ${a.name}`,contexts:["selection"],onclick:b=>{onTransClick(b,a.code)}})}),1<b.length&&chrome.contextMenus.create({type:"separator",contexts:["selection"]}),1!==b.length&&chrome.contextMenus.create({title:0===b.length?"Translate Options...":"More...",contexts:["selection"],onclick:()=>{chrome.runtime.openOptionsPage()}}),chrome.contextMenus.create({title:"Translate Options...",contexts:["page"],onclick:()=>{chrome.runtime.openOptionsPage()}})});